(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5706],{58389:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/chat",function(){return a(84929)}])},48050:function(e,t,a){"use strict";a.d(t,{a:function(){return s}});var r=a(67294),n=a(12808);let s=()=>{(0,r.useEffect)(()=>{n.w.push({event:"page_view"})},[])}},5379:function(e,t,a){"use strict";a.d(t,{l:function(){return r.useSearchParams}});var r=a(39332)},84929:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return e8}});var r=a(85893),n=a(67294),s=a(11347),i=a(87357),c=a(67720),o=a(93946),l=a(53219),d=a(98396),h=a(8425),u=a(48050),x=a(5379),p=a(8493),m=a(15861);let f=()=>(0,r.jsxs)(i.Z,{sx:{alignItems:"center",display:"flex",flexGrow:1,flexDirection:"column",justifyContent:"center",overflow:"hidden"},children:[(0,r.jsx)(i.Z,{component:"img",src:"/assets/errors/error-404.png",sx:{height:"auto",maxWidth:120}}),(0,r.jsx)(m.Z,{color:"text.secondary",sx:{mt:2},variant:"subtitle1",children:"Start meaningful conversations!"})]});var y=a(59599),g=a(45025),v=a(10459),j=a(93649),Z=a(35634),b=a(7069),C=a(88330),k=a(1784);let w=new Date,T=[{id:"5e8891ab188cd2855e6029b7",avatar:"/assets/avatars/avatar-alcides-antonio.png",isActive:!0,lastActivity:w.getTime(),name:"Alcides Antonio"},{id:"5e887a62195cc5aef7e8ca5d",avatar:"/assets/avatars/avatar-marcus-finn.png",isActive:!1,lastActivity:(0,C.Z)(w,2).getTime(),name:"Marcus Finn"},{id:"5e887ac47eed253091be10cb",avatar:"/assets/avatars/avatar-carson-darrin.png",isActive:!1,lastActivity:(0,k.Z)(w,15).getTime(),name:"Carson Darrin"},{id:"5e887b209c28ac3dd97f6db5",avatar:"/assets/avatars/avatar-fran-perez.png",isActive:!0,lastActivity:w.getTime(),name:"Fran Perez"},{id:"5e887b7602bdbc4dbb234b27",avatar:"/assets/avatars/avatar-jie-yan-song.png",isActive:!0,lastActivity:w.getTime(),name:"Jie Yan Song"},{id:"5e86805e2bafd54f66cc95c3",avatar:"/assets/avatars/avatar-miron-vitold.png",isActive:!1,lastActivity:(0,C.Z)(w,1).getTime(),name:"Miron Vitold"},{id:"5e887a1fbefd7938eea9c981",avatar:"/assets/avatars/avatar-penjani-inyene.png",isActive:!1,lastActivity:(0,C.Z)(w,6).getTime(),name:"Penjani Inyene"},{id:"5e887d0b3d090c1b8f162003",avatar:"/assets/avatars/avatar-omar-darboe.png",isActive:!0,lastActivity:w.getTime(),name:"Omar Darobe"},{id:"5e88792be2d4cfb4bf0971d9",avatar:"/assets/avatars/avatar-siegbert-gottfried.png",isActive:!0,lastActivity:w.getTime(),name:"Siegbert Gottfried"},{id:"5e8877da9a65442b11551975",avatar:"/assets/avatars/avatar-iulia-albu.png",isActive:!0,lastActivity:w.getTime(),name:"Iulia Albu"},{id:"5e8680e60cba5019c5ca6fda",avatar:"/assets/avatars/avatar-nasimiyu-danai.png",isActive:!0,lastActivity:w.getTime(),name:"Nasimiyu Danai"}],A=[{id:"5e867eb9de721aecaccf4f7b",messages:[{id:"5e867f0a5bc0ff2bfa07bfa6",attachments:[],body:"Hey, nice projects! I really liked the one in react. What's your quote on kinda similar project?",contentType:"text",createdAt:(0,b.Z)((0,C.Z)(w,10),4).getTime(),authorId:"5e86805e2bafd54f66cc95c3"},{id:"5e867f167d5f78109ae9f2a4",attachments:[],body:"I would need to know more details, but my hourly rate stats at $35/hour. Thanks!",contentType:"text",createdAt:(0,b.Z)((0,C.Z)(w,2),4).getTime(),authorId:"5e86809283e28b96d2d38537"},{id:"5e867f1c9ca72084693528f4",attachments:[],body:"Well it's a really easy one, I'm sure we can make it half of the price.",contentType:"text",createdAt:(0,C.Z)(w,5).getTime(),authorId:"5e86805e2bafd54f66cc95c3"},{id:"5e867f22fd2e27a09849b4db",attachments:[],body:"Then why don't you make it if it's that easy? Sorry I'm not interetes, have fantastic day Adam!",contentType:"text",createdAt:(0,C.Z)(w,3).getTime(),authorId:"5e86809283e28b96d2d38537"},{id:"5e867f28a34d45ac6eb5c41f",attachments:[],body:"Last offer, $25 per hour",contentType:"text",createdAt:(0,C.Z)(w,2).getTime(),authorId:"5e86805e2bafd54f66cc95c3"},{id:"5e867f2dba984a3f78b33526",attachments:[],body:"/assets/covers/minimal-1-4x3-small.png",contentType:"image",createdAt:(0,C.Z)(w,1).getTime(),authorId:"5e86805e2bafd54f66cc95c3"}],participantIds:["5e86809283e28b96d2d38537","5e86805e2bafd54f66cc95c3"],type:"ONE_TO_ONE",unreadCount:2},{id:"5e867fa7082c3c5921403a26",messages:[{id:"5e867fc180837d901bd9bca1",attachments:[],body:"Hey, would you like to collaborate?",contentType:"text",createdAt:(0,b.Z)((0,k.Z)(w,6),3).getTime(),authorId:"5e8680e60cba5019c5ca6fda"},{id:"5e8d6fb695df7971237fc173",attachments:[],body:"Hi, Merrile!",contentType:"text",createdAt:(0,b.Z)((0,k.Z)(w,5),3).getTime(),authorId:"5e86809283e28b96d2d38537"},{id:"58825a290eb4d4271a54f188",attachments:[],body:"Hello everyone \uD83D\uDE00",contentType:"text",createdAt:(0,b.Z)((0,k.Z)(w,2),1).getTime(),authorId:"5e8891ab188cd2855e6029b7"}],participantIds:["5e86809283e28b96d2d38537","5e8680e60cba5019c5ca6fda","5e8891ab188cd2855e6029b7"],type:"GROUP",unreadCount:0}],I={id:"5e86809283e28b96d2d38537",avatar:"/assets/avatars/avatar-anika-visser.png",name:"Anika Visser"},S=e=>A.find(t=>t.id===e),E=e=>A.find(t=>{if(t.participantIds.length!==e.length)return!1;let a=new Set;return t.participantIds.forEach(t=>{e.includes(t)&&a.add(t)}),a.size===e.length}),P=new class{getContacts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{query:t}=e;return new Promise((e,a)=>{try{let a=T;if(t){let e=t.toLowerCase().trim();a=a.filter(t=>t.name.toLowerCase().includes(e))}e((0,Z.p)(a))}catch(e){console.error("[Chat Api]: ",e),a(Error("Internal server error"))}})}getThreads(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=A.map(e=>{let t=[I];return T.forEach(a=>{e.participantIds.includes(a.id)&&t.push({id:a.id,avatar:a.avatar,lastActivity:a.lastActivity,name:a.name})}),{...e,participants:t}});return Promise.resolve((0,Z.p)(e))}getThread(e){let{threadKey:t}=e;return new Promise((e,a)=>{if(!t){a(Error("Thread key is required"));return}try{let a;let r=T.find(e=>e.id===t);if(r&&(a=E([I.id,r.id])),a||(a=S(t)),!a)return e(null);let n=[I];T.forEach(e=>{a.participantIds.includes(e.id)&&n.push({id:e.id,avatar:e.avatar,lastActivity:e.lastActivity,name:e.name})});let s={...a,participants:n};e((0,Z.p)(s))}catch(e){console.error("[Chat Api]: ",e),a(Error("Internal server error"))}})}markThreadAsSeen(e){let{threadId:t}=e;return new Promise((e,a)=>{try{let a=A.find(e=>e.id===t);a&&(a.unreadCount=0),e(!0)}catch(e){console.error("[Chat Api]: ",e),a(Error("Internal server error"))}})}getParticipants(e){let{threadKey:t}=e;return new Promise((e,a)=>{try{let r=[I],n=S(t);if(n)T.forEach(e=>{n.participantIds.includes(e.id)&&r.push({id:e.id,avatar:e.avatar,lastActivity:e.lastActivity,name:e.name})});else{let e=T.find(e=>e.id===t);if(!e){a(Error("Unable to find the contact"));return}r.push({id:e.id,avatar:e.avatar,lastActivity:e.lastActivity,name:e.name})}return e(r)}catch(e){console.error("[Chat Api]: ",e),a(Error("Internal server error"))}})}addMessage(e){let{threadId:t,recipientIds:a,body:r}=e;return new Promise((e,n)=>{try{let s;if(!(t||a)){n(Error("Thread ID or recipient IDs has to be provided"));return}if(t){if(!(s=S(t))){n(Error("Invalid thread id"));return}}else{let e=[I.id,...a||[]];s=E(e)}if(!s){let e=[I.id,...a||[]];s={id:(0,j.h)(),messages:[],participantIds:e,type:2===e.length?"ONE_TO_ONE":"GROUP",unreadCount:0},A.push(s)}let i={id:(0,j.h)(),attachments:[],body:r,contentType:"text",createdAt:new Date().getTime(),authorId:I.id};s.messages.push(i),e({threadId:s.id,message:i})}catch(e){console.error("[Chat Api]: ",e),n(Error("Internal server error"))}})}};var R=a(87343);let D={addMessage:e=>async t=>{let a=await P.addMessage(e);return t(R.t.actions.addMessage(a)),a.threadId},getContacts:()=>async e=>{let t=await P.getContacts({});e(R.t.actions.getContacts(t))},getThread:e=>async t=>{let a=await P.getThread(e);return t(R.t.actions.getThread(a)),null==a?void 0:a.id},getThreads:()=>async e=>{let t=await P.getThreads();e(R.t.actions.getThreads(t))},markThreadAsSeen:e=>async t=>{await P.markThreadAsSeen(e),t(R.t.actions.markThreadAsSeen(e.threadId))},setCurrentThread:e=>t=>{t(R.t.actions.setCurrentThread(e.threadId))}};var M=a(45697),W=a.n(M),O=a(95226),_=a(87952),F=a(87918),G=a(23926),H=a(87109),N=a(78462),q=a(18987),L=a(98619),U=a(59334),K=a(57709),z=a(11791),B=a(16078),V=a(51233),X=a(78777);let $=e=>{let{onRecipientAdd:t,onRecipientRemove:a,recipients:s=[],...c}=e,o=(0,n.useRef)(null),[d,h]=(0,n.useState)(!1),[u,x]=(0,n.useState)(""),[p,f]=(0,n.useState)([]),y=!!(d&&u),g=p.length>0,v=(0,n.useCallback)(async e=>{let t=e.target.value;if(x(t),!t){f([]);return}try{let e=await P.getContacts({query:t}),a=s.map(e=>e.id),r=e.filter(e=>!a.includes(e.id));f(r)}catch(e){console.error(e)}},[s]),j=(0,n.useCallback)(()=>{y&&h(!1)},[y]),Z=(0,n.useCallback)(()=>{h(!0)},[]),b=(0,n.useCallback)(e=>{x(""),null==t||t(e)},[t]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(i.Z,{...c,children:(0,r.jsx)(X.L,{children:(0,r.jsxs)(i.Z,{sx:{alignItems:"center",display:"flex",p:2},children:[(0,r.jsx)(G.Z,{onClickAway:j,children:(0,r.jsxs)(i.Z,{sx:{mr:1},children:[(0,r.jsx)(K.Z,{fullWidth:!0,onChange:v,onFocus:Z,placeholder:"Search contacts",ref:o,startAdornment:(0,r.jsx)(H.Z,{position:"start",children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(O.Z,{})})}),sx:{"&.MuiInputBase-root":{height:40,minWidth:260}},value:u}),y&&(0,r.jsx)(B.Z,{anchorEl:o.current,open:d,placement:"bottom-start",children:(0,r.jsx)(z.Z,{elevation:16,sx:{borderColor:"divider",borderStyle:"solid",borderWidth:1,maxWidth:"100%",mt:1,width:320},children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:{px:2,pt:2},children:(0,r.jsx)(m.Z,{color:"text.secondary",variant:"subtitle2",children:"Contacts"})}),(0,r.jsx)(N.Z,{children:p.map(e=>(0,r.jsxs)(L.Z,{onClick:()=>b(e),children:[(0,r.jsx)(q.Z,{children:(0,r.jsx)(_.Z,{src:e.avatar})}),(0,r.jsx)(U.Z,{primary:e.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"}})]},e.id))})]}):(0,r.jsxs)(i.Z,{sx:{p:2,textAlign:"center"},children:[(0,r.jsx)(m.Z,{gutterBottom:!0,variant:"h6",children:"Nothing Found"}),(0,r.jsxs)(m.Z,{color:"text.secondary",variant:"body2",children:["We couldn't find any matches for \"",u,'". Try checking for typos or using complete words.']})]})})})]})}),(0,r.jsx)(m.Z,{color:"text.secondary",sx:{mr:2},variant:"body2",children:"To:"}),(0,r.jsx)(V.Z,{alignItems:"center",direction:"row",spacing:2,children:s.map(e=>(0,r.jsx)(F.Z,{avatar:(0,r.jsx)(_.Z,{src:e.avatar}),label:e.name,onDelete:()=>null==a?void 0:a(e.id)},e.id))})]})})})})};$.propTypes={onRecipientAdd:W().func,onRecipientRemove:W().func,recipients:W().array};var J=a(35485),Y=a(51647),Q=a(3753),ee=a(34386),et=a(21991);let ea=e=>{let{disabled:t=!1,onSend:a,...s}=e,c=(0,et.I)(),d=(0,n.useRef)(null),[h,u]=(0,n.useState)(""),x=(0,n.useCallback)(()=>{var e;null===(e=d.current)||void 0===e||e.click()},[]),p=(0,n.useCallback)(e=>{u(e.target.value)},[]),m=(0,n.useCallback)(()=>{h&&(null==a||a(h),u(""))},[h,a]),f=(0,n.useCallback)(e=>{"Enter"===e.code&&m()},[m]);return(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",spacing:2,sx:{px:3,py:1},...s,children:[(0,r.jsx)(_.Z,{sx:{display:{xs:"none",sm:"inline"}},src:c.avatar}),(0,r.jsx)(K.Z,{disabled:t,fullWidth:!0,onChange:p,onKeyUp:f,placeholder:"Leave a message",size:"small",value:h}),(0,r.jsxs)(i.Z,{sx:{alignItems:"center",display:"flex",m:-2,ml:2},children:[(0,r.jsx)(ee.Z,{title:"Send",children:(0,r.jsx)(i.Z,{sx:{m:1},children:(0,r.jsx)(o.Z,{color:"primary",disabled:!h||t,sx:{backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark"}},onClick:m,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(Q.Z,{})})})})}),(0,r.jsx)(ee.Z,{title:"Attach photo",children:(0,r.jsx)(i.Z,{sx:{display:{xs:"none",sm:"inline-flex"},m:1},children:(0,r.jsx)(o.Z,{disabled:t,edge:"end",onClick:x,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(Y.Z,{})})})})}),(0,r.jsx)(ee.Z,{title:"Attach file",children:(0,r.jsx)(i.Z,{sx:{display:{xs:"none",sm:"inline-flex"},m:1},children:(0,r.jsx)(o.Z,{disabled:t,edge:"end",onClick:x,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(J.Z,{})})})})})]}),(0,r.jsx)("input",{hidden:!0,ref:d,type:"file"})]})};ea.propTypes={disabled:W().bool,onSend:W().func};let er=()=>{let[e,t]=(0,n.useState)([]),a=(0,n.useCallback)(e=>{t(t=>{let a=t.find(t=>t.id===e.id);return a?t:[...t,e]})},[]),r=(0,n.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]);return{handleRecipientAdd:a,handleRecipientRemove:r,recipients:e}},en=e=>{let t=(0,v.I0)(),a=(0,y.t)(),{handleRecipientAdd:s,handleRecipientRemove:o,recipients:l}=er(),d=(0,n.useCallback)(async e=>{let r;let n=l.map(e=>e.id);try{r=await t(D.addMessage({recipientIds:n,body:e}))}catch(e){console.error(e);return}a.push(g.H.dashboard.chat+"?threadKey=".concat(r))},[t,a,l]),h=l.length>0;return(0,r.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",flexGrow:1},...e,children:[(0,r.jsx)($,{onRecipientAdd:s,onRecipientRemove:o,recipients:l}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(i.Z,{sx:{flexGrow:1}}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(ea,{disabled:!h,onSend:d})]})};var es=a(90948);let ei=(0,es.ZP)("div",{shouldForwardProp:e=>"open"!==e})(e=>{let{theme:t,open:a}=e;return{display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden",[t.breakpoints.up("md")]:{marginLeft:-380},transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),...a&&{[t.breakpoints.up("md")]:{marginLeft:0},transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})}}});var ec=a(10216),eo=a(45331),el=a(11057),ed=a(77533),eh=a(92869);let eu=(0,n.forwardRef)(function(e,t){let{isFocused:a,onChange:s,onClickAway:c=()=>{},onFocus:o,onSelect:d,query:h="",results:u=[],...x}=e,p=(0,n.useCallback)(e=>{null==d||d(e)},[d]),f=u.length>0;return(0,r.jsx)(G.Z,{onClickAway:c,children:(0,r.jsxs)(i.Z,{ref:t,sx:{p:2},...x,children:[(0,r.jsx)(K.Z,{fullWidth:!0,onChange:s,onFocus:o,placeholder:"Search contacts",startAdornment:(0,r.jsx)(H.Z,{position:"start",children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(O.Z,{})})}),value:h}),a&&!h&&(0,r.jsx)(i.Z,{sx:{py:2},children:(0,r.jsx)(eh.C,{message:"Enter a contact name"})}),a&&h&&(0,r.jsx)(r.Fragment,{children:f?(0,r.jsxs)(i.Z,{sx:{py:2},children:[(0,r.jsx)(m.Z,{color:"text.secondary",variant:"subtitle2",children:"Contacts"}),(0,r.jsx)(N.Z,{children:u.map(e=>(0,r.jsxs)(L.Z,{onClick:()=>p(e),children:[(0,r.jsx)(q.Z,{children:(0,r.jsx)(_.Z,{src:e.avatar,sx:{height:32,width:32}})}),(0,r.jsx)(U.Z,{primary:e.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"}})]},e.id))})]}):(0,r.jsx)(i.Z,{sx:{py:2},children:(0,r.jsxs)(m.Z,{color:"text.secondary",variant:"body2",children:["We couldn't find any matches for \"",h,'". Try checking for typos or using complete words.']})})})]})})});eu.propTypes={isFocused:W().bool,onChange:W().func,onClickAway:W().func,onFocus:W().func,onSelect:W().func,query:W().string,results:W().array};var ex=a(12195),ep=a(54801),em=a(51107),ef=a(13328);let ey=e=>{var t;return null===(t=e.messages)||void 0===t?void 0:t[e.messages.length-1]},eg=(e,t)=>e.filter(e=>e.id!==t),ev=e=>e.map(e=>e.name).join(", "),ej=(e,t)=>{if(!t)return"";let a=t.authorId===e?"Me: ":"",r="image"===t.contentType?"Sent a photo":t.body;return"".concat(a).concat(r)},eZ=e=>e?(0,ex.Z)(e.createdAt,new Date,{addSuffix:!1,locale:ef.Z}):null,eb=e=>{let{active:t=!1,thread:a,onSelect:n,...s}=e,c=(0,et.I)(),o=eg(a.participants||[],c.id),l=ey(a),d=eZ(l),h=ev(o),u=ej(c.id,l),x=o.length>1,p=!!(a.unreadCount&&a.unreadCount>0);return(0,r.jsxs)(V.Z,{component:"li",direction:"row",onClick:n,spacing:2,sx:{borderRadius:2.5,cursor:"pointer",px:3,py:2,"&:hover":{backgroundColor:"action.hover"},...t&&{backgroundColor:"action.hover"}},...s,children:[(0,r.jsx)("div",{children:(0,r.jsx)(em.Z,{max:2,sx:{["& .".concat(ep.Z.root)]:x?{height:26,width:26,"&:nth-of-type(2)":{mt:"10px"}}:{height:36,width:36}},children:o.map(e=>(0,r.jsx)(_.Z,{src:e.avatar||void 0},e.id))})}),(0,r.jsxs)(i.Z,{sx:{flexGrow:1,overflow:"hidden"},children:[(0,r.jsx)(m.Z,{noWrap:!0,variant:"subtitle2",children:h}),(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",spacing:1,children:[p&&(0,r.jsx)(i.Z,{sx:{backgroundColor:"primary.main",borderRadius:"50%",height:8,width:8}}),(0,r.jsx)(m.Z,{color:"text.secondary",noWrap:!0,sx:{flexGrow:1},variant:"subtitle2",children:u})]})]}),d&&(0,r.jsx)(m.Z,{color:"text.secondary",sx:{whiteSpace:"nowrap"},variant:"caption",children:d})]})};eb.propTypes={active:W().bool,onSelect:W().func,thread:W().object.isRequired};let eC=(e,t)=>"GROUP"===e.type?e.id:e.participantIds.find(e=>e!==t),ek=()=>(0,v.v9)(e=>e.chat.threads),ew=()=>(0,v.v9)(e=>e.chat.currentThreadId),eT=e=>{let{container:t,onClose:a,open:s,...c}=e,h=(0,et.I)(),u=(0,y.t)(),x=ek(),p=ew(),[f,v]=(0,n.useState)(!1),[j,Z]=(0,n.useState)(""),[b,C]=(0,n.useState)([]),k=(0,d.Z)(e=>e.breakpoints.up("md")),w=(0,n.useCallback)(()=>{u.push(g.H.dashboard.chat+"?compose=true")},[u]),T=(0,n.useCallback)(async e=>{let{value:t}=e.target;if(Z(t),!t){C([]);return}try{let e=await P.getContacts({query:t});C(e)}catch(e){console.error(e)}},[]),A=(0,n.useCallback)(()=>{f&&(v(!1),Z(""))},[f]),I=(0,n.useCallback)(()=>{v(!0)},[]),S=(0,n.useCallback)(e=>{let t=e.id;v(!1),Z(""),u.push(g.H.dashboard.chat+"?threadKey=".concat(t))},[u]),E=(0,n.useCallback)(e=>{let t=x.byId[e],a=eC(t,h.id);a?u.push(g.H.dashboard.chat+"?threadKey=".concat(a)):u.push(g.H.dashboard.chat)},[u,x,h]),R=(0,r.jsxs)("div",{children:[(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",spacing:2,sx:{p:2},children:[(0,r.jsx)(m.Z,{variant:"h5",sx:{flexGrow:1},children:"Chats"}),(0,r.jsx)(el.Z,{onClick:w,startIcon:(0,r.jsx)(l.Z,{children:(0,r.jsx)(ec.Z,{})}),variant:"contained",children:"Group"}),!k&&(0,r.jsx)(o.Z,{onClick:a,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eo.Z,{})})})]}),(0,r.jsx)(eu,{isFocused:f,onChange:T,onClickAway:A,onFocus:I,onSelect:S,query:j,results:b}),(0,r.jsx)(i.Z,{sx:{display:f?"none":"block"},children:(0,r.jsx)(X.L,{children:(0,r.jsx)(V.Z,{component:"ul",spacing:.5,sx:{listStyle:"none",m:0,p:2},children:x.allIds.map(e=>(0,r.jsx)(eb,{active:p===e,onSelect:()=>E(e),thread:x.byId[e]},e))})})})]});return k?(0,r.jsx)(ed.ZP,{anchor:"left",open:s,PaperProps:{sx:{position:"relative",width:380}},SlideProps:{container:t},variant:"persistent",...c,children:R}):(0,r.jsx)(ed.ZP,{anchor:"left",hideBackdrop:!0,ModalProps:{container:t,sx:{pointerEvents:"none",position:"absolute"}},onClose:a,open:s,PaperProps:{sx:{maxWidth:"100%",width:380,pointerEvents:"auto",position:"absolute"}},SlideProps:{container:t},variant:"temporary",...c,children:R})};eT.propTypes={container:W().any,onClose:W().func,open:W().bool};var eA=a(44086),eI=a(66242),eS=a(83965),eE=a(23795);let eP=e=>{let{authorAvatar:t,authorName:a,body:n,contentType:s,createdAt:c,position:o,...l}=e,d=(0,eA.Z)(c);return(0,r.jsx)(i.Z,{sx:{display:"flex",alignItems:"right"===o?"flex-end":"flex-start"},...l,children:(0,r.jsxs)(V.Z,{alignItems:"flex-start",direction:"right"===o?"row-reverse":"row",spacing:2,sx:{maxWidth:500,ml:"right"===o?"auto":0,mr:"left"===o?"auto":0},children:[(0,r.jsx)(_.Z,{src:t||void 0,sx:{height:32,width:32}}),(0,r.jsxs)(i.Z,{sx:{flexGrow:1},children:[(0,r.jsxs)(eI.Z,{sx:{backgroundColor:"right"===o?"primary.main":"background.paper",color:"right"===o?"primary.contrastText":"text.primary",px:2,py:1},children:[(0,r.jsx)(i.Z,{sx:{mb:1},children:(0,r.jsx)(eE.Z,{color:"inherit",sx:{cursor:"pointer"},variant:"subtitle2",children:a})}),"image"===s&&(0,r.jsx)(eS.Z,{onClick:()=>{},image:n,sx:{height:200,width:200}}),"text"===s&&(0,r.jsx)(m.Z,{color:"inherit",variant:"body1",children:n})]}),(0,r.jsx)(i.Z,{sx:{display:"flex",justifyContent:"right"===o?"flex-end":"flex-start",mt:1,px:2},children:(0,r.jsxs)(m.Z,{color:"text.secondary",noWrap:!0,variant:"caption",children:[d," ago"]})})]})]})})};eP.propTypes={authorAvatar:W().string.isRequired,authorName:W().string.isRequired,body:W().string.isRequired,contentType:W().string.isRequired,createdAt:W().number.isRequired,position:W().oneOf(["left","right"])};let eR=(e,t,a)=>{let r=t.find(t=>t.id===e.authorId);return r?e.authorId===a.id?{name:"Me",avatar:a.avatar,isUser:!0}:{avatar:r.avatar,name:r.name,isUser:!1}:{name:"Unknown",avatar:"",isUser:!1}},eD=e=>{let{messages:t=[],participants:a=[],...n}=e,s=(0,et.I)();return(0,r.jsx)(V.Z,{spacing:2,sx:{p:3},...n,children:t.map(e=>{let t=eR(e,a,s);return(0,r.jsx)(eP,{authorAvatar:t.avatar,authorName:t.name,body:e.body,contentType:e.contentType,createdAt:e.createdAt,position:t.isUser?"right":"left"},e.id)})})};eD.propTypes={messages:W().array,participants:W().array};var eM=a(97512),eW=a(46621),eO=a(83075),e_=a(12046),eF=a(39628),eG=a(72591),eH=a(48885),eN=a(25464),eq=a(63931),eL=a(73539);let eU=(e,t)=>e.filter(e=>e.id!==t),eK=e=>e.map(e=>e.name).join(", "),ez=e=>{let t=1===e.length&&e[0].lastActivity;return t?(0,eA.Z)(e[0].lastActivity,{addSuffix:!0}):null},eB=e=>{let{participants:t=[],...a}=e,n=(0,et.I)(),s=(0,eL.S)(),i=eU(t,n.id),c=eK(i),d=ez(i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{flexShrink:0,minHeight:64,px:2,py:1},...a,children:[(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",spacing:2,children:[(0,r.jsx)(em.Z,{max:2,sx:{...i.length>1&&{"& .MuiAvatar-root":{height:30,width:30,"&:nth-of-type(2)":{mt:"10px"}}}},children:i.map(e=>(0,r.jsx)(_.Z,{src:e.avatar||void 0},e.id))}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{variant:"subtitle2",children:c}),d&&(0,r.jsxs)(m.Z,{color:"text.secondary",variant:"caption",children:["Last active ",d]})]})]}),(0,r.jsxs)(V.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,r.jsx)(o.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(e_.Z,{})})}),(0,r.jsx)(o.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(Y.Z,{})})}),(0,r.jsx)(ee.Z,{title:"More options",children:(0,r.jsx)(o.Z,{onClick:s.handleOpen,ref:s.anchorRef,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eO.Z,{})})})})]})]}),(0,r.jsxs)(eN.Z,{anchorEl:s.anchorRef.current,keepMounted:!0,onClose:s.handleClose,open:s.open,children:[(0,r.jsxs)(eq.Z,{children:[(0,r.jsx)(eH.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eF.Z,{})})}),(0,r.jsx)(U.Z,{primary:"Block"})]}),(0,r.jsxs)(eq.Z,{children:[(0,r.jsx)(eH.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eG.Z,{})})}),(0,r.jsx)(U.Z,{primary:"Delete"})]}),(0,r.jsxs)(eq.Z,{children:[(0,r.jsx)(eH.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eM.Z,{})})}),(0,r.jsx)(U.Z,{primary:"Archive"})]}),(0,r.jsxs)(eq.Z,{children:[(0,r.jsx)(eH.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(eW.Z,{})})}),(0,r.jsx)(U.Z,{primary:"Mute"})]})]})]})};eB.propTypes={participants:W().array};let eV=e=>{let t=(0,y.t)(),[a,r]=(0,n.useState)([]),s=(0,n.useCallback)(async()=>{try{let t=await P.getParticipants({threadKey:e});r(t)}catch(e){console.error(e),t.push(g.H.dashboard.chat)}},[t,e]);return(0,n.useEffect)(()=>{s()},[e]),a},eX=e=>{let t=(0,y.t)(),a=(0,v.I0)(),r=(0,v.v9)(e=>{let{threads:t,currentThreadId:a}=e.chat;return t.byId[a]}),s=(0,n.useCallback)(async()=>{let r;try{r=await a(D.getThread({threadKey:e}))}catch(e){console.error(e),t.push(g.H.dashboard.chat);return}a(D.setCurrentThread({threadId:r})),r&&a(D.markThreadAsSeen({threadId:r}))},[t,a,e]);return(0,n.useEffect)(()=>{s()},[e]),r},e$=e=>{let t=(0,n.useRef)(null),a=(0,n.useCallback)(()=>{if(!e||!t.current)return;let a=t.current,r=a.getScrollElement();r&&(r.scrollTop=a.el.scrollHeight)},[e]);return(0,n.useEffect)(()=>{a()},[e]),{messagesRef:t}},eJ=e=>{let{threadKey:t,...a}=e,s=(0,v.I0)(),o=(0,et.I)(),l=eX(t),d=eV(t),{messagesRef:h}=e$(l),u=(0,n.useCallback)(async e=>{let t;if(l){try{await s(D.addMessage({threadId:l.id,body:e}))}catch(e){console.error(e)}return}let a=d.filter(e=>e.id!==o.id).map(e=>e.id);try{t=await s(D.addMessage({recipientIds:a,body:e}))}catch(e){console.error(e);return}try{await s(D.getThread({threadKey:t}))}catch(e){console.error(e);return}s(D.setCurrentThread({threadId:t}))},[s,d,l,o]);return(0,r.jsxs)(V.Z,{sx:{flexGrow:1,overflow:"hidden"},...a,children:[(0,r.jsx)(eB,{participants:d}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(i.Z,{sx:{flexGrow:1,overflow:"hidden"},children:(0,r.jsx)(X.L,{ref:h,sx:{maxHeight:"100%"},children:(0,r.jsx)(eD,{messages:(null==l?void 0:l.messages)||[],participants:(null==l?void 0:l.participants)||[]})})}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(ea,{onSend:u})]})};eJ.propTypes={threadKey:W().string.isRequired};let eY=()=>{let e=(0,v.I0)(),t=(0,n.useCallback)(()=>{e(D.getThreads())},[e]);(0,n.useEffect)(()=>{t()},[])},eQ=()=>{let e=(0,x.l)(),t=(0,d.Z)(e=>e.breakpoints.up("md")),[a,r]=(0,n.useState)(t),s=(0,n.useCallback)(()=>{t?r(!0):r(!1)},[t]);(0,n.useEffect)(()=>{s()},[t]);let i=(0,n.useCallback)(()=>{t||r(!1)},[t]);(0,n.useEffect)(()=>{i()},[e]);let c=(0,n.useCallback)(()=>{r(e=>!e)},[]),o=(0,n.useCallback)(()=>{r(!1)},[]);return{handleToggle:c,handleClose:o,open:a}},e0=()=>{let e=(0,n.useRef)(null),t=(0,x.l)(),a="true"===t.get("compose"),d=t.get("threadKey")||void 0,p=eQ();(0,u.a)(),eY();let m=d?"thread":a?"compose":"blank";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.p,{title:"Dashboard: Chat"}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(i.Z,{component:"main",sx:{backgroundColor:"background.paper",flex:"1 1 auto",overflow:"hidden",position:"relative"},children:(0,r.jsxs)(i.Z,{ref:e,sx:{bottom:0,display:"flex",left:0,position:"absolute",right:0,top:0},children:[(0,r.jsx)(eT,{container:e.current,onClose:p.handleClose,open:p.open}),(0,r.jsxs)(ei,{open:p.open,children:[(0,r.jsx)(i.Z,{sx:{p:2},children:(0,r.jsx)(o.Z,{onClick:p.handleToggle,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(s.Z,{})})})}),(0,r.jsx)(c.Z,{}),"thread"===m&&(0,r.jsx)(eJ,{threadKey:d}),"compose"===m&&(0,r.jsx)(en,{}),"blank"===m&&(0,r.jsx)(f,{})]})]})})]})};e0.getLayout=e=>(0,r.jsx)(p.A,{children:e});var e8=e0},35634:function(e,t,a){"use strict";a.d(t,{p:function(){return function e(t){return"object"!=typeof t||null===t?t:t instanceof Date?new Date(t.getTime()):t instanceof Array?t.reduce((t,a,r)=>(t[r]=e(a),t),[]):t instanceof Object?Object.keys(t).reduce((a,r)=>(a[r]=e(t[r]),a),{}):void 0}}})}},function(e){e.O(0,[4310,8471,7176,3155,3852,3473,4411,209,7974,3126,865,9774,2888,179],function(){return e(e.s=58389)}),_N_E=e.O()}]);